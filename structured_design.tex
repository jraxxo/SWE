%% nicht vergessen draft raus zu nehmen, um echte Bilder einzubinden und die Problem-Vierecke verschwinden zu lassen
\documentclass[11pt,a4paper,oneside,svgnames]{report}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{eurosym}
\usepackage[british]{babel}

\usepackage{ae}
\usepackage{hyperref}
\usepackage[table]{xcolor}
\usepackage{colortbl}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{kpfonts}
\usepackage[explicit]{titlesec}
\usepackage[acronym,nonumberlist,style=tree]{glossaries}
\usepackage{amssymb}
\usepackage[left=3.65cm,right=3.65cm]{geometry}
\usepackage{listings}

\hypersetup{pdfpagemode=UseNone}

%BEGIN Chapter Definition

\makeatletter
\def\thickhrulefill{\leavevmode \leaders \hrule height 1ex \hfill \kern \z@}
\def\@makechapterhead#1{%
  \vspace*{10\p@}%
  {\parindent \z@ \raggedleft \reset@font
            \scshape \@chapapp{} \thechapter
        \par\nobreak
        \interlinepenalty\@M
    \Huge \bfseries #1\par\nobreak
    %\vspace*{1\p@}%
    \hrulefill
    \par\nobreak
    \vskip 50\p@
  }}
\def\@makeschapterhead#1{%
  \vspace*{10\p@}%
  {\parindent \z@ \raggedleft \reset@font
            \scshape \vphantom{\@chapapp{} \thechapter}
        \par\nobreak
        \interlinepenalty\@M
    \Huge \bfseries #1\par\nobreak
    %\vspace*{1\p@}%
    \hrulefill
    \par\nobreak
    \vskip 50\p@
  }}

%END Chapter Definition

%BEGIN Title Definition

\makeatletter
\def\thickhrulefill{\leavevmode \leaders \hrule height 1pt\hfill \kern \z@}
\renewcommand{\maketitle}{\begin{titlepage}%
    \let\footnotesize\small
    \let\footnoterule\relax
    \parindent \z@
    \reset@font
    \null\vfil
    \begin{flushleft}
      \huge \@title
    \end{flushleft}
    \par
    \hrule height 4pt
    \par
    \begin{flushright}
      \LARGE \@author \par
    \end{flushright}
    \vskip 60\p@
    \vfil\null
  \end{titlepage}%
  \setcounter{footnote}{0}%
}

%END Title Definition

%Verschissener rotierter Text für verschissene Tabelle 14.1/2
\makeatletter
\newsavebox\zzz
\def\mystrut{%
\dimen@\wd\zzz
\divide\dimen@\thr@@
\advance\dimen@-\dp\@arstrutbox
\rule\z@\dimen@}

\def\rotatezzz{%
\rotatebox{90}{\rlap{\kern-\dp\@arstrutbox\usebox\zzz}}}
%END Verschissener rotierter Text

\makeatother
\title{Structured Design for Project ``BookExpress''}
\author{Marc A. Harnos\\ {mharnos@gmail.com} \and Joscha Rapp\\ {jraxxo@gmail.com} \and Christian Schulz\\ {crs.s@gmx.net}}
\author{Marc A. Harnos\\ Joscha Rapp\\ Christian Schulz}
\date{October 2012}



\definecolor{tableHead}{HTML}{40DD0E}
\definecolor{tableEven}{HTML}{D7FCCC}
\definecolor{tableOdd}{HTML}{F0FEEC}
\definecolor{tableFoot}{HTML}{40DD0E}
\renewcommand{\arraystretch}{1.25}

\makeglossaries

\newglossaryentry{mvc}{name=MVC,description={Model View Controller},plural=MVCs, first={Model View Controller (MVC)}}

\newglossaryentry{jsp}{name=JSP,description={Java Server Page},plural=JSPs, first={Java Server Page (JSP)}, firstplural={Java Server Pages (JSPs)}}

\newacronym{led}{LED}{light-emitting diode}


\begin{document}

\maketitle
\tableofcontents

\chapter*{Document History}

\begin{center}

\begin{tabular}{|l|l|l|l|}
\hline 
Editor(s) & Date & Purpose of Editing & Version \\ 
\hline 
Harnos, Rapp, Schulz & 2012-10-01 & Initial Document Creation & v0.01 \\ 
\hline
Harnos, Rapp & 2012-10-08 & Fick Das & v0.02 \\ 
\hline
Schulz & 2012-10-08 & Fick Das Nicht - Überstimmt & v0.03 \\ 
\hline 
\end{tabular} 

\end{center}


\chapter{Introduction}
This structured design gives a detailed overview of the software design and system architecture, based on the previously developed requirement analysis and structured analysis. The structured design should be later on used for the implementation of the "BookExpress" system.

This document describes the specifications for the software architecture, the functional abstraction layer of the previously defined data flow diagrams and detailed specification of the system modules.

The description of the specific modules will vary in abstraction, allowing the software architect to implement his own, or the companies preferred, standards, without interfering in product functionality; whenever necessary the definitions provided will be more granular ensuring consistent quality and enforcing expected behaviour.

Some description will have overlapping information with the requirements specification, in case this document is sent stand alone, to assure all information is being provided.

\chapter{Software Architecture}
The software architecture of a system is the set of structures needed to reason about the system, which comprise software elements, relations among them, and properties of both. The term also refers to documentation of a system's "software architecture".\footnote{ Clements, Paul; Felix Bachmann, Len Bass, David Garlan, James Ivers, Reed Little, Paulo Merson, Robert Nord, Judith Stafford (2010). Documenting Software Architectures: Views and Beyond, Second Edition. Boston: Addison-Wesley. ISBN 0-321-55268-7.}\footnote{Bass, Len; Paul Clements, Rick Kazman (2012). Software Architecture In Practice, Third Edition. Boston: Addison-Wesley. pp. 25–37. ISBN 0-321-81573-4.}

In this chapter the programming pattern which the software architect has to implement is discussed at first, then common techniques for standardizing the code and enhancing readability and the used software and at last the implementation of the pattern into the software solution itself.

\section{Programming Pattern}
The "BookExpress" software should implement a simple \gls{mvc} pattern separating the user visible output from the internal data processing structures much like CSS separates the styling of a webpage from the HTML markup.

The "Model" part of this set up fetches data from databases and holds them in objects - it is essentially the "data storage" of the application. The controller and view must not make any database queries, all data required for the specific controller/view has to be provided by the model itself, which in turn does make the necessary database requests. This can speed up the data retrieving process with smart caching times on the model part and also ensures a higher level of security by minimizing the chance of SQL-Injections possibly performed on the view.

The "View" is essentially anything the user gets to see on his side of the application - the user interface. It also is the only point where the user can interact with the application, evaluating and providing data. The view itself can only retrieve data from the model, it can never make direct database lookups.

The "Controller" holds the business and processing logic of the software. It decides which view should be displayed to the user and which model could be used. Any data sent from the view/the user is processed by the controller and sent to the appropriate models.

In the "BookExpress" software there are two different implementations of this \gls{mvc} pattern. The web interface is the view component for the book shops and publishers, they interact with this view over their web browsers.
For this view, the controller is implemented on the application server as a web server, providing requested views and processing delivered input data. The communication between the view and controller is made over the standard network protocol tcp/ip and the data transmitted varies from standard HTML/text pages to compressed JSON data, for asynchronous and dynamic client view updates.

The "Model" in the first - and also in the second - set up is the application server itself, on which the web server runs. The application server is on the same machine as the web server, but logically a separate entity; it has access to the database server, which can also run on the same hardware, but also could run on a different machine. The data transmitted from model to controller and vice versa is composed of data objects transmitted binary for instant usage on the individual server; we do not have to compress data here, or serialize it, for the lack of data travelling distance.

In the second case, when the "BookExpress" employees use the client application software, the \gls{mvc} varies a bit from the web interface implementation. Here the view \textbf{and} controller are both implemented in the application software itself, only the model is on the application server in an different location. Therefore the data transmitted from controller to model and vice versa has to be compressed and serialized, utilizing JSON and gzip compression to accomplish fast serialisation and minimisation for faster response times and as little as possible data transferred.

TODO: Add an image illustrating this model

\section{Programming Techniques and Software}
For standardisations and readabilities sake simple rules should be honoured to ensure a consistent look of program code, making it for new software architects joining the team easier to understand the code and find code bits faster. Those rules are arbitrary and should be agreed upon the development team; they should be defined at the beginning of the project and extended if necessary. An example for such a rule would be the placement of curly brackets after method declarations, they could be defined directly after the declaration or in a new line.

\lstset{
	tabsize=4,
	rulecolor=,
	language=Java,
        basicstyle=\scriptsize,
        upquote=true,
        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=true,
        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        frame=single,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
        captionpos=b
}

\begin{lstlisting}[caption={Example of method declaration with curly braces in single and new line},label=javaCodeExampleCurlyBraces]
/*
 * Example for main method with curly braces directly 
 * after method declaration
 */
public static void main(String[] argv) {
	String where = "down below";
	System.out.println("Your code goes " + where);
}

/*
 * This main method declaration has the curly braces 
 * after a line break
 */
public static void main(String[] args)
{
	System.out.println("Your code goes here, maybe.");
}
\end{lstlisting}

The application server should be implemented with a Java application server; it does not matter if this server application is commercial or open source, as long as it is Sun/Oracle certified for Java EE application servers\footnote{http://www.oracle.com/technetwork/java/javaee/overview/compatibility-jsp-136984.html}.
The server could be a WebSphere Application Server from IBM, but also an TomEE from Apache, as long as it has all the required server modules for running a web server.

Java EE should be used due to a number of advantages:
\begin{itemize}
	\item Implementation of MVC pattern comes naturally with Java EE application servers, because of how Java in general works and in particular the application server is modelled
	\item It is a very popular software used by many companies, so the chances that the implementing software architect has already experience with it is very likely
	\item The web server system is faster than common PHP servers, due to the compilation of web pages rather than script interpretation
\end{itemize}

For the database there is also the choice between a proprietary, commercial system like DB2 from IBM or an open source solution like a MySQL server; the important thing is, that the database supports standard SQL queries - not requiring the alteration of SQL statements/queries for the sake of proprietary solutions like special JOIN cases on some Microsoft database systems.

\section{Implementation}
\subsection{Data Storage/Application Server (Model)}
The model, which runs on the Java application server, has a intermediate connection to the database server and delivers the required information for the view and controller in form of Java Beans or JSON strings.

The model also has an implemented security layer, denying access to data, which the user has no privileges to and blocking malicious requests. This security layer has to work quick, and in general the model has to be very responsive, due to the high data load.

\subsection{Web Interface (View)}
The view is the point, the interaction between the book stores, publishers and the system takes place. The web interface should look the same, and work with any new and standards compliant web browser; the supported browsers should at least include Mozilla Firefox from version 3.5 onwards, Chrome, Opera from version 9 onwards, Safari, and Internet Explorer from version 10 onwards.

The view itself should output standard complaint HTML5 code, and use modern JavaScript libraries to enhance the user experience and make user work flow easier to understand, i.e. by implementing visual clues which data is currently missing and suggesting search and input terms where appropriate.

The work flow has to be easy to understand, and the input fields and buttons should be recognised fast and placed on similar locations for each individual task, for faster learning curves and easy and fast pattern remembering.

\subsection{Application Server/Web Server (Controller)}
The controller is processing user data, which always implies input errors and the possibility of an attack to the system. The data has to be checked for any inconsistency regarding data type and for missing data - also any attempt of system intrusion has to be recognised and prevented.
The controller has a security and rights management layer implemented, preventing users from seeing data which they have no access to or visiting sites, they should not be able to see.

The controller is running on a web server and is realised through \glspl{jsp}.

\subsection{Client Application (Controller/View)}
The client application is a stand alone Java application which incorporates the controller and view into one program. The data is retrieved from the application server and transmitted serialised through JSON strings. Hereby security is very important, the data is never transmitted without encryption ensuring packages could not be sniffed over the network. If the controller has to be written so it cannot be manipulated in a form, where the user is given more rights than he actually has - without model authorisation the controller should not be able to process any data to the view.

The client application should be very responsive and fast - it also should integrate in the system very well enabling features as drag\&drop and the support for specialised hardware like graphical tablets for signature processing and bar code readers and gps tracking devices.

\section{Model Layers}
TODO: insert image picturing the modules sorted by layer

\section{Module Relations/Dependencies}
\chapter{Environment / General~Architecture}
\section{Application Server}
\section{Web Server}
\section{Database Server}
\section{Server Environment}
\section{Client Environment}
\chapter{Software Modules}
\chapter{Data Dictionary}

\section{User Data}

\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Client File & = & \{Client Data\} \\
\\
Client Data & = & Client PIN\\
&  & + Address\\
&  & + Correspondent\\
&  & + Contract Data\\
&  & + \{Order\}\\
&  & + \{Invoice\}\\
&  & + (Sales Volume)\\
&  & + Login Data \\
& = & Publisher Data\\
& = & Book Store Data\\
\\
Address & = & [Street + Street Number $|$ Post-Office Box]\\
&  & + Name\\
&  & +  (Country Symbol)\\
&  & +  Postal Code\\
&  & + City\\
&  & + Phone Number\\
&  & + (Fax)\\
&  & + Email Address\\
\\
Name & = & Form Of Address\\
&  & + (Title)\\
&  & + Forename\\
&  & + Surname\\
&  & + (Trade Name)\\
& = & Author\\
& = & Publisher\\
& = & Driver\\
\\
Login Data & = & [Client PIN $|$ Employee PIN]\\
&  & + Password \\
\\
Correspondent & = & Name\\
&  & + (Email)\\
\end{tabular}


\section{Order Data}

\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Order & = & Order Data\\
\\
Order Data & = & Order PIN\\
&  & + 1\{Article\}\\
&  & + Order Status\\
&  & + Date \\
\\
Order Status & = & [Processing $|$ Valid $|$ Invalid $|$ Logistics $|$ Delivery $|$ Delivered $|$ Canceled] \\
\\
Date & = & Hour\\
&  & + Minute\\
&  & + Day\\
&  & + Month\\
&  & + Year\\
\end{tabular}

\section{Internal Data}

\subsection{Book Stock}
\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Stock & = & \{Article\} \\
\\
Article & = & Book Data\\
&  & + Amount\\
\\
Book Data & = & [ISBN $|$ UPC $|$ EAN]\\
&  & + 1\{Author\}\\
&  & + Title\\
&  & + Publisher\\
&  & + (Article Cover)\\
&  & + Price\\
&  & + Availability\\
\\
Availability & = & [In Stock $|$ Ordered at Publisher $|$ N/A]\\
\end{tabular}

\subsection{Truck Information}

\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Truck Fleet Data & = & Driver\\
&  & + Registration Number\\
&  & + Truck Status \\
\\
Truck Status & = & [Boxing $|$ Parcel Sorting Centre $|$ Delivering $|$ Traffic Jam $|$ Delivered] \\
\end{tabular}

\subsection{User Data}
\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Contract Data & = & Contract PIN\\
& & + Signing Date\\
& & + [Client Data $|$ Employee Data]\\
& & + File On Server\\
\\
Signing Date & = & Day\\
&  & + Month\\
&  & + Year\\
\\
Invoice & = & Client Data\\
&  & + Order\\
&  & + Invoice PIN\\
&  & + Invoice Status\\
\\
Invoice Status & = & [Paid $|$ Open]\\
\end{tabular}

\subsection{Employee}

\begin{tabular}{p{3.5cm}p{0.5cm}p{8.5cm}}
Employee File & = & \{Employee Data\}\\
\\
Employee Data & = & Employee PIN\\
&  & + Address\\
&  & + Contract Data\\
&  & + Login Data\\
&  & + Administrator\\
\\
Administrator & = & [True $|$ False]
\end{tabular}


\chapter{Appendices}
\addcontentsline{toc}{section}{Glossary}
\addcontentsline{toc}{section}{Acronyms}
\printglossaries

\end{document}